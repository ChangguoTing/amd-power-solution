<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- âœ… é‡è¦ï¼šæ²’æœ‰é€™è¡Œï¼Œæ‰‹æ©Ÿå¸¸å¸¸ä¸æœƒç…§ä½ é æœŸçš„æ–·é»èˆ‡å¯¬åº¦è¡Œç‚º -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>AMD AC vs. DC Efficiency Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- å…¨å±€è¨­å®š --- */
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            background-color: #f9fafb; 
            color: #333; 
            height: 100vh; 
            display: flex; 
            flex-direction: column;

            /* âœ… ä¸è¦ç”¨å…¨åŸŸ min-width å¡æ­»æ‰‹æ©Ÿ */
            overflow-x: hidden;
        }

        /* âœ… æ¡Œæ©Ÿæ‰éœ€è¦ min-widthï¼ˆç¶­æŒä½ åŸæœ¬æ¡Œæ©Ÿé«”é©—ï¼‰ */
        @media (min-width: 1200px) {
            body {
                min-width: 1200px;
                overflow-x: auto;
            }
        }
        
        /* Header */
        header { 
            background-color: #ffffff; 
            padding: 0 30px; 
            height: 70px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
            flex-shrink: 0; 
        }
        .brand { display: flex; align-items: center; gap: 15px; }
        .brand img { height: 24px; width: auto; display: block; }
        .title { 
            font-size: 18px; font-weight: 600; text-transform: uppercase; color: #6b7280; letter-spacing: 1px;
            border-left: 2px solid #e5e7eb; padding-left: 15px;
        }
        
        /* Layout */
        .container { 
            display: flex; 
            flex: 1; 
            padding: 30px; 
            gap: 30px; 
            overflow: hidden; 
            max-width: 1600px; 
            margin: 0 auto; 
            width: 100%; 
            box-sizing: border-box; 
        }
        
        /* --- å·¦å´ï¼šè¼¸å…¥å€ --- */
        .left-panel { 
            width: 45%; 
            display: flex; 
            flex-direction: column; 
            gap: 20px; 
            overflow-y: auto; 
            padding-right: 10px; 
        }
        
        /* --- è¼¸å…¥ç¾¤çµ„æ¨£å¼ (AMD é¢¨æ ¼) --- */
        .input-group { 
            background: #ffffff; border: 1px solid #d1d5db; border-radius: 6px; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.05); overflow: hidden; flex-shrink: 0;
        }
        .group-header { 
            background: #f3f4f6; color: #111827; padding: 12px 20px; font-weight: 700; font-size: 13px; 
            display: flex; justify-content: space-between; border-bottom: 1px solid #d1d5db; 
            text-transform: uppercase; letter-spacing: 0.5px; border-left: 4px solid #ED1C24;
        }
        .group-header i { color: #6b7280; cursor: pointer; }
        
        .group-body { padding: 20px; display: flex; flex-direction: column; gap: 15px; }

        /* è¼¸å…¥åˆ— */
        .control-row { display: flex; align-items: center; justify-content: space-between; font-size: 13px; color: #4b5563; }
        .control-row label { flex: 1.2; font-weight: 600; }
        .slider-container { flex: 1.5; display: flex; align-items: center; gap: 15px; }
        
        /* æ»‘æ¡¿æ¨£å¼ */
        input[type="range"] { 
            flex: 1; height: 6px; background: #e5e7eb; border-radius: 3px; outline: none; appearance: none; -webkit-appearance: none; cursor: pointer;
        }
        input[type="range"]::-webkit-slider-thumb { 
            appearance: none; -webkit-appearance: none; width: 18px; height: 18px; 
            background: #000; border: 2px solid #fff; border-radius: 50%; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: transform 0.1s;
        }
        input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.1); background: #ED1C24; }

        .val-display { font-weight: 700; width: 50px; text-align: right; color: #ED1C24; font-family: monospace; font-size: 14px; }

        /* ä¸‹æ‹‰é¸å–® */
        .styled-select {
            width: 100%; padding: 8px 10px; border: 1px solid #d1d5db; border-radius: 4px; 
            background-color: #fff; color: #374151; font-size: 13px; outline: none; cursor: pointer;
        }

        /* --- å³å´ï¼šçµæœå€ --- */
        .right-panel { 
            width: 55%; 
            display: flex; 
            flex-direction: column; 
            gap: 20px;

            /* âœ… æ¡Œæ©Ÿä½ åŸæœ¬æ˜¯ç½®ä¸­ï¼ŒOK */
            justify-content: center; 
        }
        
        .result-box { 
            background: #ffffff; border: 1px solid #d1d5db; border-radius: 6px; 
            display: flex; flex-direction: column; box-shadow: 0 2px 5px rgba(0,0,0,0.03);
            height: 550px; 
        }
        .result-header { 
            background: #fff; color: #111827; padding: 20px; font-weight: 700; font-size: 16px; 
            display: flex; justify-content: space-between; border-bottom: 1px solid #f3f4f6; text-transform: uppercase;
        }
        .chart-area { padding: 20px; flex: 1; position: relative; }

        /* åœ–ä¾‹ */
        .custom-legend { 
            display: flex; justify-content: center; gap: 25px; padding: 15px; 
            font-size: 13px; color: #4b5563; background: #fff; border-top: 1px solid #f3f4f6;
            flex-wrap: wrap;
        }
        .legend-item { display: flex; align-items: center; gap: 8px; font-weight: 600; }
        .color-box { width: 14px; height: 14px; border-radius: 3px; }

        /* =========================================================
           âœ… æ‰‹æ©Ÿç‰ˆï¼šç¶­æŒå·¦å³å…©æ¬„ + å…è¨±æ©«å‘æ»‘å‹• + åœ–è¡¨åœ¨å³ä¸Šè§’
           ========================================================= */
        @media (max-width: 900px) {
            header { padding: 0 16px; }
            .title { font-size: 14px; }

            /* âœ… è®“æ•´å€‹å…©æ¬„å®¹å™¨å¯ä»¥æ°´å¹³æ»‘å‹•ï¼Œä¸è¦å †ç–Š */
            .container {
                padding: 16px;
                gap: 16px;
                overflow-x: auto;               /* ğŸ”¥ è®“ä½ æ‰‹æ©Ÿå¯æ»‘åˆ°å³é‚Šçš„åœ–è¡¨ */
                -webkit-overflow-scrolling: touch;
                align-items: flex-start;         /* ğŸ”¥ å·¦å³æ¬„éƒ½å¾é ‚éƒ¨å°é½Š */
            }

            /* âœ… å¼·åˆ¶å…©æ¬„éƒ½æœ‰å›ºå®šå¯¬åº¦ï¼šæ‰‹æ©Ÿæ‰ä¸æœƒæŠŠå³æ¬„æ“ åˆ°ä¸‹é¢ */
            .left-panel  { flex: 0 0 430px; width: auto; max-height: calc(100vh - 70px - 32px); }
            .right-panel { flex: 0 0 520px; width: auto; }

            /* âœ… é—œéµï¼šæ‰‹æ©Ÿæ™‚æŠŠå³æ¬„æ”¹æˆé ‚éƒ¨å°é½Šï¼ˆä½ è¦çš„ã€Œå³ä¸Šè§’ã€æ„Ÿè¦ºï¼‰ */
            .right-panel { justify-content: flex-start; }

            /* å°èª¿æ•´ï¼šé¿å…åœ–è¡¨å¤ªé«˜æŠŠç¬¬ä¸€å±æ’çˆ† */
            .result-box { height: 460px; }
        }
    </style>
</head>

<body>
    <header>
        <div class="brand">
            <img src="https://upload.wikimedia.org/wikipedia/commons/7/7c/AMD_Logo.svg" alt="AMD Logo">
            <div class="title">Data Center Efficiency Calculator</div>
        </div>
        <div><i class="fas fa-bolt" style="color: #9ca3af; font-size: 20px;"></i></div>
    </header>

    <div class="container">
        <div class="left-panel">
            <div class="input-group">
                <div class="group-header">Power Solution Selection</div>
                <div class="group-body">
                    <select id="solutionSelect" class="styled-select" onchange="updateSolutionImage()">
                        <option value="mtool1.svg">Traditional AC + LVDC IT</option>
                        <option value="mtool2.svg">Traditional AC + HVDC IT</option>
                        <option value="mtool3.svg">LVDC Sidecar + LVDC IT</option>
                        <option value="mtool4.svg">HVDC Sidecar + LVDC IT</option>
                        <option value="mtool5.svg">HVDC Sidecar + HVDC IT</option>
                        <option value="mtool6.svg">800V SST + LVDC IT</option>
                        <option value="mtool7.svg">800V SST + HVDC IT</option>
                    </select>
                </div>
            </div>

            <div class="input-group">
                <div class="group-header">Architecture Diagram</div>
                <div class="group-body" style="padding: 10px; align-items: center; justify-content: center; background-color: #fff;">
                    <img id="solutionImage" src="mtool1.svg" alt="Solution Diagram" style="width: 100%; height: auto; border-radius: 4px; display: block;">
                </div>
            </div>

            <div style="font-size: 16px; font-weight: 700; color: #111827; margin-bottom: 10px; border-bottom: 2px solid #e5e7eb; padding-bottom: 5px; margin-top: 10px;">INPUTS</div>

            <div class="input-group">
                <div class="group-header">MV Xâ€™mer / SST <i class="far fa-question-circle"></i></div>
                <div class="group-body">
                    <div class="control-row">
                        <label>Efficiency</label>
                        <div class="slider-container">
                            <input type="range" id="eff_stage1" min="90" max="99.9" step="0.1" value="96.3" oninput="calc()">
                            <span class="val-display" id="val_stage1">96.3%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <div class="group-header">UPS / Sidecar <i class="far fa-question-circle"></i></div>
                <div class="group-body">
                    <div class="control-row">
                        <label>Efficiency</label>
                        <div class="slider-container">
                            <input type="range" id="eff_stage2" min="90" max="99.9" step="0.1" value="98.3" oninput="calc()">
                            <span class="val-display" id="val_stage2">98.3%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <div class="group-header">AC / HVDC Distribution <i class="far fa-question-circle"></i></div>
                <div class="group-body">
                    <div class="control-row">
                        <label>Distribution Wiring Efficiency</label>
                        <div class="slider-container">
                            <input type="range" id="eff_dist" min="95" max="99.9" step="0.1" value="99.5" oninput="calc()">
                            <span class="val-display" id="val_dist">99.5%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <div class="group-header">IT Bus Bar <i class="far fa-question-circle"></i></div>
                <div class="group-body">
                    <div class="control-row">
                        <label>Efficiency</label>
                        <div class="slider-container">
                            <input type="range" id="eff_stage3" min="90" max="99.9" step="0.1" value="99.0" oninput="calc()">
                            <span class="val-display" id="val_stage3">99.0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <div class="group-header">Power Supply / DC DC <i class="far fa-question-circle"></i></div>
                <div class="group-body">
                    <div class="control-row">
                        <label>Power Supply Efficiency</label>
                        <div class="slider-container">
                            <input type="range" id="eff_stage4_1" min="80" max="99.9" step="0.1" value="96.0" oninput="calc()">
                            <span class="val-display" id="val_stage4_1">96.0%</span>
                        </div>
                    </div>
                    <div class="control-row">
                        <label>DC DC Efficiency</label>
                        <div class="slider-container">
                            <input type="range" id="eff_stage4_2" min="80" max="99.9" step="0.1" value="98.0" oninput="calc()">
                            <span class="val-display" id="val_stage4_2">98.0%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="right-panel">
            <div class="result-box">
                <div class="result-header">Power Path Efficiency (%)</div>
                <div class="chart-area"><canvas id="chartEff"></canvas></div>
                <div class="custom-legend">
                    <div class="legend-item"><div class="color-box" style="background:#D1D5DB"></div>Infrastructure Eff.</div>
                    <div class="legend-item"><div class="color-box" style="background:#9CA3AF"></div>Power Distribution Eff.</div>
                    <div class="legend-item"><div class="color-box" style="background:#6B7280"></div>IT Power Eff.</div>
                    <div class="legend-item"><div class="color-box" style="background:#ED1C24"></div>Total Power Eff.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        Chart.defaults.font.family = "'Segoe UI', sans-serif";
        Chart.defaults.color = '#374151'; 
        Chart.defaults.font.size = 12;

        const colors = ['#D1D5DB', '#9CA3AF', '#6B7280', '#ED1C24']; 
        const labels = ['Infrastructure Eff.', 'Power Distribution Eff.', 'IT Power Eff.', 'Total Power Eff.'];

        let chartEff;

        function initCharts() {
            const ctx = document.getElementById('chartEff').getContext('2d');
            chartEff = new Chart(ctx, {
                type: 'bar',
                data: { labels: labels, datasets: [{ data: [0,0,0,0], backgroundColor: colors, barPercentage: 0.5, borderRadius: 6 }] },
                options: { 
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { display: false }, 
                        tooltip: { enabled: true, backgroundColor: '#1f2937', padding: 12 },
                        datalabels: { 
                            anchor: 'end', align: 'top', color: '#374151', font: { weight: 'bold', size: 14 }, 
                            formatter: (v)=>v.toFixed(1) + '%' 
                        } 
                    },
                    layout: { padding: { top: 30 } },
                    scales: {
                        x: { display: true, grid: { display: false }, ticks: { font: { weight: '700', size: 13 } } },
                        y: { beginAtZero: false, min: 60, max: 100, grid: { color: '#f3f4f6' } }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function calc() {
            const mv_sst = parseFloat(document.getElementById('eff_stage1').value) / 100;
            const ups_sidecar = parseFloat(document.getElementById('eff_stage2').value) / 100;
            const dist = parseFloat(document.getElementById('eff_dist').value) / 100;
            const it_busbar = parseFloat(document.getElementById('eff_stage3').value) / 100;
            const psu = parseFloat(document.getElementById('eff_stage4_1').value) / 100;
            const dcdc = parseFloat(document.getElementById('eff_stage4_2').value) / 100;

            document.getElementById('val_stage1').innerText = (mv_sst*100).toFixed(1) + "%";
            document.getElementById('val_stage2').innerText = (ups_sidecar*100).toFixed(1) + "%";
            document.getElementById('val_dist').innerText = (dist*100).toFixed(1) + "%";
            document.getElementById('val_stage3').innerText = (it_busbar*100).toFixed(1) + "%";
            document.getElementById('val_stage4_1').innerText = (psu*100).toFixed(1) + "%";
            document.getElementById('val_stage4_2').innerText = (dcdc*100).toFixed(1) + "%";

            const infraEff = mv_sst * ups_sidecar;
            const powerDistEff = dist;
            const itPowerEff = it_busbar * psu * dcdc;
            const totalPowerEff = infraEff * powerDistEff * itPowerEff;

            const effData = [
                infraEff * 100,
                powerDistEff * 100,
                itPowerEff * 100,
                totalPowerEff * 100
            ];

            chartEff.data.datasets[0].data = effData;
            chartEff.update();
        }

        function updateSolutionImage() {
            const select = document.getElementById('solutionSelect');
            const img = document.getElementById('solutionImage');
            img.src = select.value;
        }

        initCharts();
        calc();
        updateSolutionImage();
    </script>
</body>
</html>
